<div class="box box-primary">
  <div class="box-header with-border">
    <h3 class="box-title"><center>Facturas</center></h3>
    <a href="<%=new_invoice_path%>" class="btn btn-primary pull-right" role="button">Nueva Factura</a> 
  </div>
  <div class="box-body">
    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
              <th>Numero</th>
              <th>Fecha</th>
              <th>Cliente</th>
              <th>Estado</th> 
              <th>Total</th>                                     
              <th></th>               
            </tr>
          </thead>
        <tbody>
           <% @invoices.each do |invoice| %>
              <tr>
                <td><%= invoice.numero %></td>
                <td><%= invoice.fecha %></td>
                <td><%= invoice.nombre %></td>

                <!--Se determina el color del label dependiendo del estado -->                   
                <%if invoice.pendiente? %>
                  <% btn = 'warning' %>
                <%elsif invoice.pagado? %>
                  <% btn = 'success' %>
                <%elsif invoice.cancelado? %>
                  <% btn = 'danger' %>
                <%else %>
                  <% btn = 'default' %>
                <%end%>     
                <td><span class="label label-<%=btn%>"><%= invoice.state %></span></td>

                <!--Se formatea el total en formato local -->
                <td> <%= number_to_currency_py(invoice.total)%> </td>

                <td align="center">

                    <%= link_to invoice, remote: true, class: 'btn btn-primary', title: 'Ver Factura', 'data-toggle' => 'tooltip', 'data-placement' => 'rigth' do %>
                    <span class= "glyphicon glyphicon-eye-open"></span>
                    <% end %>
                    <%if !invoice.cancelado?%>                                      
                      <%= link_to invoice, method: :delete, data: { confirm: "Desea cancelar esta factura?" }, class: 'btn btn-danger', title: 'Cancelar Factura', 'data-toggle' => 'tooltip', 'data-placement' => 'rigth' do %>
                      <span class= "glyphicon glyphicon-remove"></span>
                      <% end %>
                    <% end %>                                                 
                
                </td> 
              </tr>
            <% end %>
          </tbody>
      </table>
    </div>
  </div>
</div>